{"type":"operationStart","subtype":"profile","data":{"_id":"uBctobW4hDLDgalY","timestamp":"2024-09-10T03:58:29.651Z","state":"queued","mode":"full","creationDate":"2024-09-10T03:58:29.653Z","modificationDate":"2024-09-10T03:58:29.653Z","shortid":"VLYcznX","inheritedReadPermissions":[],"inheritedEditPermissions":[],"$entitySet":"profiles"},"doDiffs":false,"timestamp":1725940709652,"id":"wc6yscu54yklth6","previousOperationId":null,"operationId":"b0l9toz1l9etvvp"}
{"type":"log","level":"info","message":"Render request 2 queued for execution and waiting for available worker","previousOperationId":"b0l9toz1l9etvvp","timestamp":1725940709652,"id":"g8h4ja8co92h6n3"}
{"type":"operationStart","subtype":"render","name":"product_outputs","previousOperationId":"b0l9toz1l9etvvp","timestamp":1725940709660,"id":"86sbfezla90of8z","previousEventId":"wc6yscu54yklth6","operationId":"cfu23dccbkr0rug","res":{"content":null,"meta":{"diff":"Index: resMeta\n===================================================================\n--- resMeta\n+++ resMeta\n@@ -1,0 +1,1 @@\n\\ No newline at end of file\n+{}\n\\ No newline at end of file\n"}},"req":{"diff":"Index: req\n===================================================================\n--- req\n+++ req\n@@ -1,0 +1,23 @@\n\\ No newline at end of file\n+{\n+  \"template\": {\n+    \"name\": \"product_outputs\",\n+    \"recipe\": \"xlsx\",\n+    \"shortid\": \"rLvgQGm-DV\",\n+    \"folder\": {\n+      \"shortid\": \"8C3byvb\"\n+    },\n+    \"engine\": \"handlebars\",\n+    \"data\": {\n+      \"shortid\": \"v7ZP4Cyjr\"\n+    },\n+    \"creationDate\": \"2024-09-10T03:47:34.837Z\",\n+    \"modificationDate\": \"2024-09-10T03:48:22.881Z\",\n+    \"inheritedReadPermissions\": [],\n+    \"inheritedEditPermissions\": [],\n+    \"xlsx\": {\n+      \"templateAssetShortid\": \"5hdQv5W\"\n+    },\n+    \"content\": \"{{{xlsxReplace}}}\"\n+  },\n+  \"data\": {}\n+}\n\\ No newline at end of file\n"}}
{"type":"log","timestamp":1725940709661,"level":"info","message":"Starting rendering request 2 (user: admin)","meta":{"rootId":"rz4q67qs5uuh5hg","id":"rz4q67qs5uuh5hg"},"id":"rmg46w3dn47ck60","previousOperationId":"cfu23dccbkr0rug"}
{"type":"log","timestamp":1725940709661,"level":"info","message":"Rendering template { name: product_outputs, recipe: xlsx, engine: handlebars, preview: true }","meta":{"rootId":"rz4q67qs5uuh5hg","id":"rz4q67qs5uuh5hg"},"id":"jeurdidiqn7ao42","previousOperationId":"cfu23dccbkr0rug"}
{"type":"log","timestamp":1725940709662,"level":"debug","message":"Adding sample data v7ZP4Cyjr","meta":{"rootId":"rz4q67qs5uuh5hg","id":"rz4q67qs5uuh5hg"},"id":"wvnuvuh2yahho6r","previousOperationId":"cfu23dccbkr0rug"}
{"type":"log","timestamp":1725940709663,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"rz4q67qs5uuh5hg","id":"rz4q67qs5uuh5hg"},"id":"itgnbwovhkpiwyy","previousOperationId":"cfu23dccbkr0rug"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1725940709664,"id":"xneopnlnqkrwyhv","previousEventId":"86sbfezla90of8z","operationId":"leiyyh1zi8l7a47","previousOperationId":"cfu23dccbkr0rug","res":{"content":null,"meta":{"diff":"Index: resMeta\n===================================================================\n--- resMeta\n+++ resMeta\n@@ -1,1 +1,1 @@\n-{}\n\\ No newline at end of file\n+{\"reportName\":\"product_outputs\",\"headers\":{}}\n\\ No newline at end of file\n"}},"req":{"diff":"Index: req\n===================================================================\n--- req\n+++ req\n@@ -4,5 +4,0 @@\n-    \"recipe\": \"xlsx\",\n-    \"shortid\": \"rLvgQGm-DV\",\n-    \"folder\": {\n-      \"shortid\": \"8C3byvb\"\n-    },\n@@ -10,0 +5,1 @@\n+    \"recipe\": \"xlsx\",\n@@ -13,0 +9,1 @@\n+    \"shortid\": \"rLvgQGm-DV\",\n@@ -17,0 +14,1 @@\n+    \"_id\": \"Hc4OYiuT2VgF4QvQ\",\n@@ -20,1 +18,5 @@\n-    \"content\": \"{{{xlsxReplace}}}\"\n+    \"content\": \"\",\n+    \"folder\": {\n+      \"shortid\": \"8C3byvb\"\n+    },\n+    \"scripts\": []\n@@ -22,1 +24,9 @@\n-  \"data\": {}\n+  \"data\": {\n+    \"$xlsxOriginalContent\": \"{{{xlsxReplace}}}\",\n+    \"$xlsxModuleDirname\": \"C:\\\\Users\\\\shsmo\\\\OneDrive\\\\Desktop\\\\Sophea\\\\templates report\\\\node_modules\\\\@jsreport\\\\jsreport-xlsx\\\\\",\n+    \"$tempAutoCleanupDirectory\": \"C:\\\\Users\\\\shsmo\\\\AppData\\\\Local\\\\Temp\\\\jsreport\\\\autocleanup\",\n+    \"$addBufferSize\": 50000000,\n+    \"$numberOfParsedAddIterations\": 50,\n+    \"$files\": [],\n+    \"$buffers\": {}\n+  }\n"}}
{"type":"log","timestamp":1725940709665,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"rz4q67qs5uuh5hg","id":"rz4q67qs5uuh5hg"},"id":"yc5lb0zlkaows6n","previousOperationId":"leiyyh1zi8l7a47"}
{"type":"operationEnd","operationId":"leiyyh1zi8l7a47","timestamp":1725940709984,"id":"asznm93iddivt3n","previousEventId":"xneopnlnqkrwyhv","previousOperationId":"leiyyh1zi8l7a47","res":{"content":null,"meta":{"diff":"Index: resMeta\n===================================================================\n--- resMeta\n+++ resMeta\n"}},"req":{"diff":"Index: req\n===================================================================\n--- req\n+++ req\n@@ -31,1 +31,4 @@\n-    \"$buffers\": {}\n+    \"$buffers\": {},\n+    \"__appDirectory\": \"C:\\\\Users\\\\shsmo\\\\OneDrive\\\\Desktop\\\\Sophea\\\\templates report\",\n+    \"__rootDirectory\": \"C:\\\\Users\\\\shsmo\\\\OneDrive\\\\Desktop\\\\Sophea\\\\templates report\\\\\",\n+    \"__parentModuleDirectory\": \"C:\\\\Users\\\\shsmo\\\\OneDrive\\\\Desktop\\\\Sophea\\\\templates report\"\n"}}
{"type":"operationStart","subtype":"recipe","name":"xlsx","timestamp":1725940709984,"id":"m8yasbz2471mm24","previousEventId":"asznm93iddivt3n","operationId":"hgrlcnqzcrn40s3","previousOperationId":"leiyyh1zi8l7a47","res":{"content":null,"meta":{"diff":"Index: resMeta\n===================================================================\n--- resMeta\n+++ resMeta\n"}},"req":{"diff":"Index: req\n===================================================================\n--- req\n+++ req\n"}}
{"type":"log","timestamp":1725940709985,"level":"debug","message":"Executing recipe xlsx","meta":{"rootId":"rz4q67qs5uuh5hg","id":"rz4q67qs5uuh5hg"},"id":"vfmubpv24t5ef51","previousOperationId":"hgrlcnqzcrn40s3"}
{"type":"log","timestamp":1725940710014,"level":"info","message":"xlsx generation is starting","meta":{"rootId":"rz4q67qs5uuh5hg","id":"rz4q67qs5uuh5hg"},"id":"wcn5b9floet25ep","previousOperationId":"hgrlcnqzcrn40s3"}
{"type":"log","timestamp":1725940710024,"level":"warn","message":"Error when processing render request 2\n(because) error while executing xlsx recipe\n(because) failed to parse xlsx template input\n(because) expected a Buffer, got undefined\nTypeError: Expected a Buffer, got undefined\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\office\\lib\\decompress.js:81:27\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\processXlsx.js:16:33\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\index.js:58:55)\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\recipe.js:5:24)\n    at async invokeRender (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:93:5)\n    at async WorkerReporter._render (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:148:7)\n    at async C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:232:24\n    at async processAndResponse (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)\nwrapped by:\nError: Failed to parse xlsx template input\n(because) expected a Buffer, got undefined\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n    at WorkerReporter.createError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:53:12)\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\processXlsx.js:18:22\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\index.js:58:28)\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\recipe.js:5:24)\n    at async invokeRender (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:93:5)\n    at async WorkerReporter._render (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:148:7)\n    at async C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:232:24\n    at async processAndResponse (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)\nwrapped by:\nError: Error while executing xlsx recipe\n(because) failed to parse xlsx template input\n(because) expected a Buffer, got undefined\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n    at WorkerReporter.createError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:53:12)\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\processXlsx.js:180:20\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\index.js:58:28)\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\recipe.js:5:24)\n    at async invokeRender (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:93:5)\n    at async WorkerReporter._render (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:148:7)\n    at async C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:232:24\n    at async processAndResponse (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)","meta":{"rootId":"rz4q67qs5uuh5hg","id":"rz4q67qs5uuh5hg"},"id":"wmofclk29vqn7u0","previousOperationId":"hgrlcnqzcrn40s3"}
{"type":"log","timestamp":1725940710024,"level":"warn","message":"Rendering request 2 finished with error in 373 ms","meta":{"rootId":"rz4q67qs5uuh5hg","id":"rz4q67qs5uuh5hg"},"id":"sli5gnotx30zcfi","previousOperationId":"hgrlcnqzcrn40s3"}
{"type":"error","timestamp":1725940710027,"weak":true,"logged":true,"previousOperationId":"hgrlcnqzcrn40s3","id":"h98dsv1grxlm70w","stack":"TypeError: Expected a Buffer, got undefined\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\office\\lib\\decompress.js:81:27\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\processXlsx.js:16:33\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\index.js:58:55)\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\recipe.js:5:24)\n    at async invokeRender (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:93:5)\n    at async WorkerReporter._render (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:148:7)\n    at async C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:232:24\n    at async processAndResponse (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)\nwrapped by:\nError: Failed to parse xlsx template input\n(because) expected a Buffer, got undefined\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n    at WorkerReporter.createError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:53:12)\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\processXlsx.js:18:22\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\index.js:58:28)\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\recipe.js:5:24)\n    at async invokeRender (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:93:5)\n    at async WorkerReporter._render (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:148:7)\n    at async C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:232:24\n    at async processAndResponse (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)\nwrapped by:\nError: Error while executing xlsx recipe\n(because) failed to parse xlsx template input\n(because) expected a Buffer, got undefined\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n    at WorkerReporter.createError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:53:12)\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\processXlsx.js:180:20\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\generation\\index.js:58:28)\n    at async module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-xlsx\\lib\\recipe.js:5:24)\n    at async invokeRender (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:93:5)\n    at async WorkerReporter._render (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:148:7)\n    at async C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:232:24\n    at async processAndResponse (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)","message":"Error while executing xlsx recipe\n(because) failed to parse xlsx template input\n(because) expected a Buffer, got undefined"}
