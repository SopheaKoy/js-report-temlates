{"type":"operationStart","subtype":"profile","data":{"_id":"VsqQTzRMsMRMx04H","timestamp":"2024-11-10T04:59:44.221Z","state":"queued","mode":"standard","creationDate":"2024-11-10T04:59:44.223Z","modificationDate":"2024-11-10T04:59:44.223Z","shortid":"puxlJDN","inheritedReadPermissions":[],"inheritedEditPermissions":[],"$entitySet":"profiles"},"doDiffs":false,"timestamp":1731214784222,"id":"ovnz4amp8911yao","previousOperationId":null,"operationId":"z9l3lws3rzxnc1w"}
{"type":"log","level":"info","message":"Render request 8 queued for execution and waiting for available worker","previousOperationId":"z9l3lws3rzxnc1w","timestamp":1731214784222,"id":"oef9flgo08d9fsf"}
{"type":"operationStart","subtype":"render","name":"testing","previousOperationId":"z9l3lws3rzxnc1w","timestamp":1731214784234,"id":"hpvr4j9awkkmek8","previousEventId":"ovnz4amp8911yao","operationId":"ntx8x1qqumyuu5l"}
{"type":"log","timestamp":1731214784234,"level":"info","message":"Starting rendering request 8 (user: admin)","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"ytu795o19mwf2lv","previousOperationId":"ntx8x1qqumyuu5l"}
{"type":"log","timestamp":1731214784234,"level":"info","message":"Rendering template { name: testing, recipe: xlsx, engine: handlebars, preview: true }","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"tahrwjlaawp6o7s","previousOperationId":"ntx8x1qqumyuu5l"}
{"type":"log","timestamp":1731214784235,"level":"debug","message":"Inline data specified.","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"hmai7ol48y7y5sb","previousOperationId":"ntx8x1qqumyuu5l"}
{"type":"log","timestamp":1731214784241,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"8m0ai9nij6zkkw0","previousOperationId":"ntx8x1qqumyuu5l"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1731214784242,"id":"68moi6mk7jzducw","previousEventId":"hpvr4j9awkkmek8","operationId":"7cl3fgnbkcnqlnt","previousOperationId":"ntx8x1qqumyuu5l"}
{"type":"log","timestamp":1731214784242,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"2d0ej34hxu1jmc3","previousOperationId":"7cl3fgnbkcnqlnt"}
{"type":"operationEnd","operationId":"7cl3fgnbkcnqlnt","timestamp":1731214784254,"id":"rpr2ov9dpppkdqa","previousEventId":"68moi6mk7jzducw","previousOperationId":"7cl3fgnbkcnqlnt"}
{"type":"operationStart","subtype":"recipe","name":"xlsx","timestamp":1731214784255,"id":"rqxncm1s09ns59f","previousEventId":"rpr2ov9dpppkdqa","operationId":"apfiyfd5olefg5g","previousOperationId":"7cl3fgnbkcnqlnt"}
{"type":"log","timestamp":1731214784255,"level":"debug","message":"Executing recipe xlsx","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"xabsrgknqq43jms","previousOperationId":"apfiyfd5olefg5g"}
{"type":"log","timestamp":1731214784255,"level":"info","message":"xlsx generation is starting","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"aasc01b63bc8r05","previousOperationId":"apfiyfd5olefg5g"}
{"type":"log","timestamp":1731214784461,"level":"debug","message":"Starting child request to render xlsx dynamic parts for generation step","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"i1y3p825pjpi1rz","previousOperationId":"apfiyfd5olefg5g"}
{"type":"operationStart","subtype":"render","name":"anonymous","previousOperationId":"apfiyfd5olefg5g","timestamp":1731214784461,"id":"zvfnq0169ymz5qb","previousEventId":"rqxncm1s09ns59f","operationId":"tnsjbmwdkkoqzkn"}
{"type":"log","timestamp":1731214784461,"level":"info","message":"Starting rendering (child) request (user: admin)","meta":{"rootId":"h3ncjhah3m30b1w","id":"mjkdsfp2jdggpqq"},"id":"340rabmt6nhbmga","previousOperationId":"tnsjbmwdkkoqzkn"}
{"type":"log","timestamp":1731214784461,"level":"info","message":"Rendering anonymous template { recipe: html, engine: handlebars }","meta":{"rootId":"h3ncjhah3m30b1w","id":"mjkdsfp2jdggpqq"},"id":"hdg8l3eq6hcvea4","previousOperationId":"tnsjbmwdkkoqzkn"}
{"type":"log","timestamp":1731214784461,"level":"debug","message":"Inline data specified.","meta":{"rootId":"h3ncjhah3m30b1w","id":"mjkdsfp2jdggpqq"},"id":"v1zzt6we9qnkn2t","previousOperationId":"tnsjbmwdkkoqzkn"}
{"type":"log","timestamp":1731214784469,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"h3ncjhah3m30b1w","id":"mjkdsfp2jdggpqq"},"id":"2xcmc7icctoy9nu","previousOperationId":"tnsjbmwdkkoqzkn"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1731214784470,"id":"o0ia14m7msc7w8g","previousEventId":"zvfnq0169ymz5qb","operationId":"0rum8ry170yb8cp","previousOperationId":"tnsjbmwdkkoqzkn"}
{"type":"log","timestamp":1731214784470,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"h3ncjhah3m30b1w","id":"mjkdsfp2jdggpqq"},"id":"dn4qdl2vfc3px09","previousOperationId":"0rum8ry170yb8cp"}
{"type":"operationEnd","operationId":"0rum8ry170yb8cp","timestamp":1731214784794,"id":"8dov8q5x14n8fpq","previousEventId":"o0ia14m7msc7w8g","previousOperationId":"0rum8ry170yb8cp"}
{"type":"operationStart","subtype":"recipe","name":"html","timestamp":1731214784795,"id":"rsfp6mvnt587o48","previousEventId":"8dov8q5x14n8fpq","operationId":"hqm225pagvz5r59","previousOperationId":"0rum8ry170yb8cp"}
{"type":"log","timestamp":1731214784795,"level":"debug","message":"Executing recipe html","meta":{"rootId":"h3ncjhah3m30b1w","id":"mjkdsfp2jdggpqq"},"id":"m191mge8e4y2ueq","previousOperationId":"hqm225pagvz5r59"}
{"type":"operationEnd","operationId":"hqm225pagvz5r59","timestamp":1731214784795,"id":"hu12gogvs7u9u5o","previousEventId":"rsfp6mvnt587o48","previousOperationId":"hqm225pagvz5r59"}
{"type":"log","timestamp":1731214784795,"level":"debug","message":"Skipping storing report.","meta":{"rootId":"h3ncjhah3m30b1w","id":"mjkdsfp2jdggpqq"},"id":"za40gjyapyqktqb","previousOperationId":"hqm225pagvz5r59"}
{"type":"log","timestamp":1731214784795,"level":"info","message":"Rendering (child) request finished in 574 ms","meta":{"rootId":"h3ncjhah3m30b1w","id":"mjkdsfp2jdggpqq"},"id":"swvcobit84uruw9","previousOperationId":"hqm225pagvz5r59"}
{"type":"operationEnd","subtype":"render","operationId":"tnsjbmwdkkoqzkn","timestamp":1731214784795,"id":"n0uqpkmid72vtcl","previousEventId":"hu12gogvs7u9u5o","previousOperationId":"hqm225pagvz5r59"}
{"type":"log","timestamp":1731214784815,"level":"debug","message":"xlsx successfully zipped","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"of8ziyvyts15c2n","previousOperationId":"apfiyfd5olefg5g"}
{"type":"log","timestamp":1731214784816,"level":"info","message":"xlsx generation was finished","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"mkoeccbp268s2gy","previousOperationId":"apfiyfd5olefg5g"}
{"type":"log","timestamp":1731214784816,"level":"info","message":"xlsx transformation is starting","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"zd97chfdr3ewsbw","previousOperationId":"apfiyfd5olefg5g"}
{"type":"log","timestamp":1731214784855,"level":"debug","message":"Parsing xlsx content","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"w0ib7phvfrbwa1s","previousOperationId":"apfiyfd5olefg5g"}
{"type":"log","timestamp":1731214784869,"level":"warn","message":"Error when processing render request 8\n(because) \"xlsxAdd\" helper call failed\n(because) cannot read properties of undefined (reading 'worksheet')\n\n(system-helpers.js line 3202:7)\n\n  3200 |       // the last must be always array, also if accessor is number, we want to initialize as array\n  3201 |       const emptySafe = ((i === paths.length - 1) || !isNaN(paths[i + 1])) ? '[]' : '{}'\n> 3202 |       new Function('obj', objReference + ' = ' + objReference + ' || ' + emptySafe)(obj)\n       |       ^\n  3203 |\n  3204 |       obj = new Function('obj', 'return ' + objReference)(obj)\n  3205 |     }\n\n(system-helpers.js line 3202:84)\n\n  3200 |       // the last must be always array, also if accessor is number, we want to initialize as array\n  3201 |       const emptySafe = ((i === paths.length - 1) || !isNaN(paths[i + 1])) ? '[]' : '{}'\n> 3202 |       new Function('obj', objReference + ' = ' + objReference + ' || ' + emptySafe)(obj)\n       |                                                                                    ^\n  3203 |\n  3204 |       obj = new Function('obj', 'return ' + objReference)(obj)\n  3205 |     }\n\n(system-helpers.js line 3162:24)\n\n  3160 |\n  3161 |     const obj = options.data.root.$xlsxTemplate[filePath]\n> 3162 |     const collection = safeGet(obj, xmlPath)\n       |                        ^\n  3163 |     const content = options.fn(context)\n  3164 |\n  3165 |     if (content != null && typeof content.then === 'function') {\n\n(system-helpers.js line 3458:17)\n\n  3456 |       }\n  3457 |\n> 3458 |       return fn.apply(this, arguments)\n       |                 ^\n  3459 |     }\n  3460 |   }\n  3461 |\n\n(system-helpers.js line 3482:25)\n\n  3480 |\n  3481 | function xlsxAdd (...args) {\n> 3482 |   return __xlsx.xlsxAdd.call(this, ...args)\n       |                         ^\n  3483 | }\n  3484 | function xlsxRemove (...args) {\n  3485 |   return __xlsx.xlsxRemove.call(this, ...args)\n\n\nTypeError: Cannot read properties of undefined (reading 'worksheet')\n    at eval (eval at safeGet (system-helpers.js:3202:7), <anonymous>:3:23)\n    at safeGet (system-helpers.js:3202:84)\n    at Object.add (system-helpers.js:3162:24)\n    at Object.<anonymous> (system-helpers.js:3458:17)\n    at Object.xlsxAdd (system-helpers.js:3482:25)\n    at Object.<anonymous> (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:429:23)\n    at Object.<anonymous> (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:87:29)\n    at Object.wrapper (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\handlebars\\dist\\cjs\\handlebars\\internal\\wrapHelper.js:15:19)\n    at eval (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:11:140)\n    at 1 (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:12:4)\nwrapped by:\nError: \"xlsxAdd\" helper call failed\n(because) cannot read properties of undefined (reading 'worksheet')\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n    at WorkerReporter.createError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:53:12)\n    at getEnhancedHelperError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:425:54)\n    at Object.<anonymous> (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:431:15)\n    at Object.<anonymous> (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:87:29)\n    at Object.wrapper (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\handlebars\\dist\\cjs\\handlebars\\internal\\wrapHelper.js:15:19)\n    at eval (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:11:140)\n    at 1 (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:12:4)\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\async-helpers\\index.js:55:26\n    at prog (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\handlebars\\dist\\cjs\\handlebars\\runtime.js:268:12)","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"btbf2rro5f1416n","previousOperationId":"apfiyfd5olefg5g"}
{"type":"log","timestamp":1731214784869,"level":"warn","message":"Rendering request 8 finished with error in 648 ms","meta":{"rootId":"h3ncjhah3m30b1w","id":"h3ncjhah3m30b1w"},"id":"639wykphxrli69q","previousOperationId":"apfiyfd5olefg5g"}
{"type":"error","timestamp":1731214784873,"lineNumber":3202,"statusCode":400,"weak":true,"decoratedSuffix":"\n\n(system-helpers.js line 3202:7)\n\n  3200 |       // the last must be always array, also if accessor is number, we want to initialize as array\n  3201 |       const emptySafe = ((i === paths.length - 1) || !isNaN(paths[i + 1])) ? '[]' : '{}'\n> 3202 |       new Function('obj', objReference + ' = ' + objReference + ' || ' + emptySafe)(obj)\n       |       ^\n  3203 |\n  3204 |       obj = new Function('obj', 'return ' + objReference)(obj)\n  3205 |     }\n\n(system-helpers.js line 3202:84)\n\n  3200 |       // the last must be always array, also if accessor is number, we want to initialize as array\n  3201 |       const emptySafe = ((i === paths.length - 1) || !isNaN(paths[i + 1])) ? '[]' : '{}'\n> 3202 |       new Function('obj', objReference + ' = ' + objReference + ' || ' + emptySafe)(obj)\n       |                                                                                    ^\n  3203 |\n  3204 |       obj = new Function('obj', 'return ' + objReference)(obj)\n  3205 |     }\n\n(system-helpers.js line 3162:24)\n\n  3160 |\n  3161 |     const obj = options.data.root.$xlsxTemplate[filePath]\n> 3162 |     const collection = safeGet(obj, xmlPath)\n       |                        ^\n  3163 |     const content = options.fn(context)\n  3164 |\n  3165 |     if (content != null && typeof content.then === 'function') {\n\n(system-helpers.js line 3458:17)\n\n  3456 |       }\n  3457 |\n> 3458 |       return fn.apply(this, arguments)\n       |                 ^\n  3459 |     }\n  3460 |   }\n  3461 |\n\n(system-helpers.js line 3482:25)\n\n  3480 |\n  3481 | function xlsxAdd (...args) {\n> 3482 |   return __xlsx.xlsxAdd.call(this, ...args)\n       |                         ^\n  3483 | }\n  3484 | function xlsxRemove (...args) {\n  3485 |   return __xlsx.xlsxRemove.call(this, ...args)\n\n","logged":true,"previousOperationId":"apfiyfd5olefg5g","id":"ex6puh8n3dd9lep","stack":"TypeError: Cannot read properties of undefined (reading 'worksheet')\n    at eval (eval at safeGet (system-helpers.js:3202:7), <anonymous>:3:23)\n    at safeGet (system-helpers.js:3202:84)\n    at Object.add (system-helpers.js:3162:24)\n    at Object.<anonymous> (system-helpers.js:3458:17)\n    at Object.xlsxAdd (system-helpers.js:3482:25)\n    at Object.<anonymous> (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:429:23)\n    at Object.<anonymous> (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:87:29)\n    at Object.wrapper (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\handlebars\\dist\\cjs\\handlebars\\internal\\wrapHelper.js:15:19)\n    at eval (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:11:140)\n    at 1 (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:12:4)\nwrapped by:\nError: \"xlsxAdd\" helper call failed\n(because) cannot read properties of undefined (reading 'worksheet')\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n    at WorkerReporter.createError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:53:12)\n    at getEnhancedHelperError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:425:54)\n    at Object.<anonymous> (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:431:15)\n    at Object.<anonymous> (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:87:29)\n    at Object.wrapper (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\handlebars\\dist\\cjs\\handlebars\\internal\\wrapHelper.js:15:19)\n    at eval (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:11:140)\n    at 1 (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:12:4)\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\async-helpers\\index.js:55:26\n    at prog (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\handlebars\\dist\\cjs\\handlebars\\runtime.js:268:12)","message":"\"xlsxAdd\" helper call failed\n(because) cannot read properties of undefined (reading 'worksheet')\n\n(system-helpers.js line 3202:7)\n\n  3200 |       // the last must be always array, also if accessor is number, we want to initialize as array\n  3201 |       const emptySafe = ((i === paths.length - 1) || !isNaN(paths[i + 1])) ? '[]' : '{}'\n> 3202 |       new Function('obj', objReference + ' = ' + objReference + ' || ' + emptySafe)(obj)\n       |       ^\n  3203 |\n  3204 |       obj = new Function('obj', 'return ' + objReference)(obj)\n  3205 |     }\n\n(system-helpers.js line 3202:84)\n\n  3200 |       // the last must be always array, also if accessor is number, we want to initialize as array\n  3201 |       const emptySafe = ((i === paths.length - 1) || !isNaN(paths[i + 1])) ? '[]' : '{}'\n> 3202 |       new Function('obj', objReference + ' = ' + objReference + ' || ' + emptySafe)(obj)\n       |                                                                                    ^\n  3203 |\n  3204 |       obj = new Function('obj', 'return ' + objReference)(obj)\n  3205 |     }\n\n(system-helpers.js line 3162:24)\n\n  3160 |\n  3161 |     const obj = options.data.root.$xlsxTemplate[filePath]\n> 3162 |     const collection = safeGet(obj, xmlPath)\n       |                        ^\n  3163 |     const content = options.fn(context)\n  3164 |\n  3165 |     if (content != null && typeof content.then === 'function') {\n\n(system-helpers.js line 3458:17)\n\n  3456 |       }\n  3457 |\n> 3458 |       return fn.apply(this, arguments)\n       |                 ^\n  3459 |     }\n  3460 |   }\n  3461 |\n\n(system-helpers.js line 3482:25)\n\n  3480 |\n  3481 | function xlsxAdd (...args) {\n> 3482 |   return __xlsx.xlsxAdd.call(this, ...args)\n       |                         ^\n  3483 | }\n  3484 | function xlsxRemove (...args) {\n  3485 |   return __xlsx.xlsxRemove.call(this, ...args)\n\n"}
