{"type":"operationStart","subtype":"profile","data":{"_id":"Yi6EAvqJsz3cfPED","timestamp":"2024-11-10T07:11:16.043Z","state":"queued","mode":"standard","creationDate":"2024-11-10T07:11:16.045Z","modificationDate":"2024-11-10T07:11:16.045Z","shortid":"N5SrgBg","inheritedReadPermissions":[],"inheritedEditPermissions":[],"$entitySet":"profiles"},"doDiffs":false,"timestamp":1731222676044,"id":"xqz1oxcr30kzcat","previousOperationId":null,"operationId":"zg1x6iafbaij76b"}
{"type":"log","level":"info","message":"Render request 58 queued for execution and waiting for available worker","previousOperationId":"zg1x6iafbaij76b","timestamp":1731222676045,"id":"ck0s6dzjwd0orfi"}
{"type":"operationStart","subtype":"render","name":"testing","previousOperationId":"zg1x6iafbaij76b","timestamp":1731222676053,"id":"3oo10xpy86qhapy","previousEventId":"xqz1oxcr30kzcat","operationId":"3s8onvz9quawiiy"}
{"type":"log","timestamp":1731222676053,"level":"info","message":"Starting rendering request 58 (user: admin)","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"lz7h2sh331z2yec","previousOperationId":"3s8onvz9quawiiy"}
{"type":"log","timestamp":1731222676053,"level":"info","message":"Rendering template { name: testing, recipe: xlsx, engine: handlebars, preview: true }","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"gyeo5tp8fo7i4u3","previousOperationId":"3s8onvz9quawiiy"}
{"type":"log","timestamp":1731222676053,"level":"debug","message":"Inline data specified.","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"qmz5hdkzfzrbojo","previousOperationId":"3s8onvz9quawiiy"}
{"type":"log","timestamp":1731222676054,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"3owiq5k3qo523j6","previousOperationId":"3s8onvz9quawiiy"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1731222676054,"id":"93ka3iea2xdgef4","previousEventId":"3oo10xpy86qhapy","operationId":"0s3m3ksypap3d3s","previousOperationId":"3s8onvz9quawiiy"}
{"type":"log","timestamp":1731222676054,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"dp7wcrhkjczbb75","previousOperationId":"0s3m3ksypap3d3s"}
{"type":"operationEnd","operationId":"0s3m3ksypap3d3s","timestamp":1731222676061,"id":"dg2j00spst55j7r","previousEventId":"93ka3iea2xdgef4","previousOperationId":"0s3m3ksypap3d3s"}
{"type":"operationStart","subtype":"recipe","name":"xlsx","timestamp":1731222676061,"id":"xpbg4qh8rnt9ma3","previousEventId":"dg2j00spst55j7r","operationId":"tmvhx0bbrv0u8ta","previousOperationId":"0s3m3ksypap3d3s"}
{"type":"log","timestamp":1731222676061,"level":"debug","message":"Executing recipe xlsx","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"iugqf7ravt3is7s","previousOperationId":"tmvhx0bbrv0u8ta"}
{"type":"log","timestamp":1731222676062,"level":"info","message":"xlsx generation is starting","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"hcdnc79z9afbupq","previousOperationId":"tmvhx0bbrv0u8ta"}
{"type":"log","timestamp":1731222676069,"level":"debug","message":"Starting child request to render xlsx dynamic parts for generation step","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"5a7mk4bdi2lftpt","previousOperationId":"tmvhx0bbrv0u8ta"}
{"type":"operationStart","subtype":"render","name":"anonymous","previousOperationId":"tmvhx0bbrv0u8ta","timestamp":1731222676069,"id":"lpapq4v9ksg2rsr","previousEventId":"xpbg4qh8rnt9ma3","operationId":"mj10itf5fbl9ir7"}
{"type":"log","timestamp":1731222676069,"level":"info","message":"Starting rendering (child) request (user: admin)","meta":{"rootId":"7f4dwo9y7a83i2d","id":"drfr9w3nfgi01vm"},"id":"4bcxcg8uzpcgj2s","previousOperationId":"mj10itf5fbl9ir7"}
{"type":"log","timestamp":1731222676069,"level":"info","message":"Rendering anonymous template { recipe: html, engine: handlebars }","meta":{"rootId":"7f4dwo9y7a83i2d","id":"drfr9w3nfgi01vm"},"id":"b0fd32dgj2szdcp","previousOperationId":"mj10itf5fbl9ir7"}
{"type":"log","timestamp":1731222676069,"level":"debug","message":"Inline data specified.","meta":{"rootId":"7f4dwo9y7a83i2d","id":"drfr9w3nfgi01vm"},"id":"l5j1pr2fuj8j4jc","previousOperationId":"mj10itf5fbl9ir7"}
{"type":"log","timestamp":1731222676070,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"7f4dwo9y7a83i2d","id":"drfr9w3nfgi01vm"},"id":"vt6urlzs71123eb","previousOperationId":"mj10itf5fbl9ir7"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1731222676070,"id":"gqrfr42nd0ouck9","previousEventId":"lpapq4v9ksg2rsr","operationId":"3usm7g35hc7umw2","previousOperationId":"mj10itf5fbl9ir7"}
{"type":"log","timestamp":1731222676070,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"7f4dwo9y7a83i2d","id":"drfr9w3nfgi01vm"},"id":"q6b2i2xd2wbg7ke","previousOperationId":"3usm7g35hc7umw2"}
{"type":"operationEnd","operationId":"3usm7g35hc7umw2","timestamp":1731222676080,"id":"1mdjz70bao1v8zd","previousEventId":"gqrfr42nd0ouck9","previousOperationId":"3usm7g35hc7umw2"}
{"type":"operationStart","subtype":"recipe","name":"html","timestamp":1731222676080,"id":"f2yelgzfcj309k4","previousEventId":"1mdjz70bao1v8zd","operationId":"3bo840g1iffzipv","previousOperationId":"3usm7g35hc7umw2"}
{"type":"log","timestamp":1731222676080,"level":"debug","message":"Executing recipe html","meta":{"rootId":"7f4dwo9y7a83i2d","id":"drfr9w3nfgi01vm"},"id":"6hg6txm6xk1tz07","previousOperationId":"3bo840g1iffzipv"}
{"type":"operationEnd","operationId":"3bo840g1iffzipv","timestamp":1731222676080,"id":"dlqggqy9wtghqxs","previousEventId":"f2yelgzfcj309k4","previousOperationId":"3bo840g1iffzipv"}
{"type":"log","timestamp":1731222676080,"level":"debug","message":"Skipping storing report.","meta":{"rootId":"7f4dwo9y7a83i2d","id":"drfr9w3nfgi01vm"},"id":"xdtx8xcwcshb8if","previousOperationId":"3bo840g1iffzipv"}
{"type":"log","timestamp":1731222676080,"level":"info","message":"Rendering (child) request finished in 37 ms","meta":{"rootId":"7f4dwo9y7a83i2d","id":"drfr9w3nfgi01vm"},"id":"v8nswruwbt6sjfw","previousOperationId":"3bo840g1iffzipv"}
{"type":"operationEnd","subtype":"render","operationId":"mj10itf5fbl9ir7","timestamp":1731222676080,"id":"ulppdjgemxl7hci","previousEventId":"dlqggqy9wtghqxs","previousOperationId":"3bo840g1iffzipv"}
{"type":"log","timestamp":1731222676092,"level":"debug","message":"xlsx successfully zipped","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"lwktyjg55a7j3ox","previousOperationId":"tmvhx0bbrv0u8ta"}
{"type":"log","timestamp":1731222676092,"level":"info","message":"xlsx generation was finished","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"cda5h2kcfs0urrh","previousOperationId":"tmvhx0bbrv0u8ta"}
{"type":"log","timestamp":1731222676092,"level":"info","message":"xlsx transformation is starting","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"7idndta54sjyazs","previousOperationId":"tmvhx0bbrv0u8ta"}
{"type":"log","timestamp":1731222676098,"level":"debug","message":"Parsing xlsx content","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"rsu53e4o6aoamzp","previousOperationId":"tmvhx0bbrv0u8ta"}
{"type":"log","timestamp":1731222676171,"level":"warn","message":"Error when processing render request 58\n(because) \"xlsxPrint\" helper call failed\n(because) buf.collection.push is not a function\n\n(system-helpers.js line 3119:20)\n\n  3117 |   function flush (buf, root) {\n  3118 |     root.$files.push(fsproxy.write(root.$tempAutoCleanupDirectory, buf.data))\n> 3119 |     buf.collection.push({ $$: root.$files.length - 1 })\n       |                    ^\n  3120 |     buf.data = ''\n  3121 |   }\n  3122 |\n\n(system-helpers.js line 3129:11)\n\n  3127 |       Object.keys(buffers[f]).forEach(function (k) {\n  3128 |         if (buffers[f][k].data.length) {\n> 3129 |           flush(buffers[f][k], root)\n       |           ^\n  3130 |         }\n  3131 |       })\n  3132 |     })\n\n(system-helpers.js line 3127:31)\n\n  3125 |\n  3126 |     Object.keys(buffers).forEach(function (f) {\n> 3127 |       Object.keys(buffers[f]).forEach(function (k) {\n       |                               ^\n  3128 |         if (buffers[f][k].data.length) {\n  3129 |           flush(buffers[f][k], root)\n  3130 |         }\n\n(system-helpers.js line 3126:26)\n\n  3124 |     const buffers = root.$buffers || {}\n  3125 |\n> 3126 |     Object.keys(buffers).forEach(function (f) {\n       |                          ^\n  3127 |       Object.keys(buffers[f]).forEach(function (k) {\n  3128 |         if (buffers[f][k].data.length) {\n  3129 |           flush(buffers[f][k], root)\n\n(system-helpers.js line 2952:5)\n\n  2950 |     const { options } = contextMap.get(this)\n  2951 |     ensureWorksheetOrder(options.data.root.$xlsxTemplate)\n> 2952 |     bufferedFlush(options.data.root)\n       |     ^\n  2953 |\n  2954 |     return JSON.stringify({\n  2955 |       $xlsxTemplate: options.data.root.$xlsxTemplate,\n\n\nTypeError: buf.collection.push is not a function\n    at flush (system-helpers.js:3119:20)\n    at system-helpers.js:3129:11\n    at Array.forEach (<anonymous>)\n    at system-helpers.js:3127:31\n    at Array.forEach (<anonymous>)\n    at bufferedFlush (system-helpers.js:3126:26)\n    at Object.print (system-helpers.js:2952:5)\n    at async eval (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:95:7)\n    at async executionFn (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:260:29)\n    at async run (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:137:16)\nwrapped by:\nError: \"xlsxPrint\" helper call failed\n(because) buf.collection.push is not a function\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n    at WorkerReporter.createError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:53:12)\n    at getEnhancedHelperError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:425:54)\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:443:15\n    at async eval (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:95:7)\n    at async executionFn (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:260:29)\n    at async run (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:137:16)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:214:14)\n    at async executeEngine (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:342:16)\n    at async templatingEnginesEvaluate (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:39:19)","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"lvz64jvziilizo6","previousOperationId":"tmvhx0bbrv0u8ta"}
{"type":"log","timestamp":1731222676171,"level":"warn","message":"Rendering request 58 finished with error in 128 ms","meta":{"rootId":"7f4dwo9y7a83i2d","id":"7f4dwo9y7a83i2d"},"id":"onvfcu4oyp1e9gs","previousOperationId":"tmvhx0bbrv0u8ta"}
{"type":"error","timestamp":1731222676175,"lineNumber":3119,"statusCode":400,"weak":true,"decoratedSuffix":"\n\n(system-helpers.js line 3119:20)\n\n  3117 |   function flush (buf, root) {\n  3118 |     root.$files.push(fsproxy.write(root.$tempAutoCleanupDirectory, buf.data))\n> 3119 |     buf.collection.push({ $$: root.$files.length - 1 })\n       |                    ^\n  3120 |     buf.data = ''\n  3121 |   }\n  3122 |\n\n(system-helpers.js line 3129:11)\n\n  3127 |       Object.keys(buffers[f]).forEach(function (k) {\n  3128 |         if (buffers[f][k].data.length) {\n> 3129 |           flush(buffers[f][k], root)\n       |           ^\n  3130 |         }\n  3131 |       })\n  3132 |     })\n\n(system-helpers.js line 3127:31)\n\n  3125 |\n  3126 |     Object.keys(buffers).forEach(function (f) {\n> 3127 |       Object.keys(buffers[f]).forEach(function (k) {\n       |                               ^\n  3128 |         if (buffers[f][k].data.length) {\n  3129 |           flush(buffers[f][k], root)\n  3130 |         }\n\n(system-helpers.js line 3126:26)\n\n  3124 |     const buffers = root.$buffers || {}\n  3125 |\n> 3126 |     Object.keys(buffers).forEach(function (f) {\n       |                          ^\n  3127 |       Object.keys(buffers[f]).forEach(function (k) {\n  3128 |         if (buffers[f][k].data.length) {\n  3129 |           flush(buffers[f][k], root)\n\n(system-helpers.js line 2952:5)\n\n  2950 |     const { options } = contextMap.get(this)\n  2951 |     ensureWorksheetOrder(options.data.root.$xlsxTemplate)\n> 2952 |     bufferedFlush(options.data.root)\n       |     ^\n  2953 |\n  2954 |     return JSON.stringify({\n  2955 |       $xlsxTemplate: options.data.root.$xlsxTemplate,\n\n","logged":true,"previousOperationId":"tmvhx0bbrv0u8ta","id":"faoj86t6wxokc8g","stack":"TypeError: buf.collection.push is not a function\n    at flush (system-helpers.js:3119:20)\n    at system-helpers.js:3129:11\n    at Array.forEach (<anonymous>)\n    at system-helpers.js:3127:31\n    at Array.forEach (<anonymous>)\n    at bufferedFlush (system-helpers.js:3126:26)\n    at Object.print (system-helpers.js:2952:5)\n    at async eval (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:95:7)\n    at async executionFn (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:260:29)\n    at async run (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:137:16)\nwrapped by:\nError: \"xlsxPrint\" helper call failed\n(because) buf.collection.push is not a function\n    at module.exports (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n    at WorkerReporter.createError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:53:12)\n    at getEnhancedHelperError (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:425:54)\n    at C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:443:15\n    at async eval (eval at compile (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-handlebars\\lib\\handlebarsEngine.js:35:30), <anonymous>:95:7)\n    at async executionFn (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:260:29)\n    at async run (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:137:16)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:214:14)\n    at async executeEngine (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:342:16)\n    at async templatingEnginesEvaluate (C:\\Users\\shsmo\\OneDrive\\Desktop\\Sophea\\templates report\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:39:19)","message":"\"xlsxPrint\" helper call failed\n(because) buf.collection.push is not a function\n\n(system-helpers.js line 3119:20)\n\n  3117 |   function flush (buf, root) {\n  3118 |     root.$files.push(fsproxy.write(root.$tempAutoCleanupDirectory, buf.data))\n> 3119 |     buf.collection.push({ $$: root.$files.length - 1 })\n       |                    ^\n  3120 |     buf.data = ''\n  3121 |   }\n  3122 |\n\n(system-helpers.js line 3129:11)\n\n  3127 |       Object.keys(buffers[f]).forEach(function (k) {\n  3128 |         if (buffers[f][k].data.length) {\n> 3129 |           flush(buffers[f][k], root)\n       |           ^\n  3130 |         }\n  3131 |       })\n  3132 |     })\n\n(system-helpers.js line 3127:31)\n\n  3125 |\n  3126 |     Object.keys(buffers).forEach(function (f) {\n> 3127 |       Object.keys(buffers[f]).forEach(function (k) {\n       |                               ^\n  3128 |         if (buffers[f][k].data.length) {\n  3129 |           flush(buffers[f][k], root)\n  3130 |         }\n\n(system-helpers.js line 3126:26)\n\n  3124 |     const buffers = root.$buffers || {}\n  3125 |\n> 3126 |     Object.keys(buffers).forEach(function (f) {\n       |                          ^\n  3127 |       Object.keys(buffers[f]).forEach(function (k) {\n  3128 |         if (buffers[f][k].data.length) {\n  3129 |           flush(buffers[f][k], root)\n\n(system-helpers.js line 2952:5)\n\n  2950 |     const { options } = contextMap.get(this)\n  2951 |     ensureWorksheetOrder(options.data.root.$xlsxTemplate)\n> 2952 |     bufferedFlush(options.data.root)\n       |     ^\n  2953 |\n  2954 |     return JSON.stringify({\n  2955 |       $xlsxTemplate: options.data.root.$xlsxTemplate,\n\n"}
